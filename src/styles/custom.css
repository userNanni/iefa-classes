/** biome-ignore-all lint/complexity/noImportantStyles: <explanation> */
@layer starlight, black, zen-mode, custom-zen-fixes, schedule-design;

@layer schedule-design {
	/* Standardize the wrapper */
	.schedule-container {
		width: 100%;
		margin: 2rem 0;
		overflow-x: auto; /* Handle horizontal overflow gracefully */
		border-radius: 8px; /* Rounded corners for the container */
		box-shadow:
			0 4px 6px -1px rgba(0, 0, 0, 0.1),
			0 2px 4px -1px rgba(0, 0, 0, 0.06); /* Subtle shadow */
		background-color: var(
			--sl-color-bg-nav
		); /* Match nav background for cohesion */
		border: 1px solid var(--sl-color-gray-5);
	}

	/* Target the table specifically within the container */
	.schedule-container table {
		width: 100%;
		border-collapse: collapse;
		margin: 0; /* Remove default margins */
		font-size: 0.95rem; /* Slightly smaller text for data density */
		display: table !important; /* Force table display overrides */
	}

	/* Header styling */
	.schedule-container th {
		background-color: var(--sl-color-black); /* Dark header */
		color: var(--sl-color-white);
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.05em;
		padding: 1rem;
		text-align: left;
		border-bottom: 2px solid var(--sl-color-accent); /* Accent line */
	}

	/* Cell styling */
	.schedule-container td {
		padding: 1rem;
		border-bottom: 1px solid var(--sl-color-hairline);
		vertical-align: top; /* Align content to top for multi-line cells */
		color: var(--sl-color-gray-2);
	}

	/* Row Hover Effect */
	.schedule-container tr:hover td {
		background-color: var(--sl-color-gray-6); /* Light highlight on hover */
		transition: background-color 0.2s ease;
	}

	/* First column special styling (Date/Time often) */
	.schedule-container td:first-child {
		font-weight: 600;
		color: var(--sl-color-text-accent);
		white-space: nowrap; /* Keep dates on one line if possible */
	}

	/* Responsive adjustment for badges inside table */
	.schedule-container .badge {
		font-size: 0.8em;
	}

	/* Remove Starlight's default table scrolling wrapper since we handle it in container */
	:where(.schedule-container)
		+ .sl-markdown-content
		> table:not(:where(.not-content *)) {
		display: table; /* Reset starlight default */
	}
}

@layer custom-zen-fixes {
	/* ============================================ */
	/* Fix 1: Show the Zen Mode toggle button      */
	/* ============================================ */

	/* The theme-black hides the Zen switcher by default */
	/* Force it to be visible in the page title area */
	.starlight-view-modes-page-title-switcher,
	.starlight-view-modes-switcher-a {
		display: inline-flex !important;
		align-items: center;
		gap: 0.5rem;
		margin-left: 0.5rem;
		opacity: 0.7;
		transition: opacity 0.2s;
	}

	.starlight-view-modes-page-title-switcher:hover,
	.starlight-view-modes-switcher-a:hover {
		opacity: 1;
	}

	/* ============================================ */
	/* Fix: Sidebar item overlap                   */
	/* ============================================ */

	/* Remove fixed height to allow items to grow with content */
	.entry-link {
		height: auto !important;
		min-height: 32px !important;
		padding: 0.5rem 1rem !important;
	}

	/* Ensure proper spacing between items */
	.entry {
		margin-bottom: 0.25rem !important;
	}

	/* Prevent text overflow */
	.entry-link span {
		overflow-wrap: break-word !important;
		word-wrap: break-word !important;
	}

	/* ============================================ */
	/* Fix 2: Hide header/sidebar in Zen Mode      */
	/* ============================================ */

	/* When Zen Mode is active, the plugin adds these divs inside the page */
	/* Use :has() to detect them and hide the appropriate elements */

	/* Hide header when no-header div exists */
	body:has(.starlight-view-modes-zen-mode-no-header) header.layout__header {
		display: none !important;
	}

	/* Hide sidebar when no-sidebar div exists */
	body:has(.starlight-view-modes-zen-mode-no-sidebar)
	:is(nav.nav-bar, aside.sidebar, aside.aside) {
		display: none !important;
	}

	/* ============================================ */
	/* Bonus: Adjust main content in Zen Mode      */
	/* ============================================ */

	/* When header is hidden, remove top padding/margin from main */
	body:has(.starlight-view-modes-zen-mode-no-header) main {
		padding-top: 2rem;
	}

	/* When sidebar is hidden, let content take full width */
	body:has(.starlight-view-modes-zen-mode-no-sidebar) .content-panel {
		max-width: 100%;
	}

	/* Fix squeezed layout in Zen Mode */
	/* Override the grid layout used by theme-black */
	body:has(.starlight-view-modes-zen-mode-no-sidebar) .container-wrapper-main {
		display: block !important;
		grid-template-columns: none !important;
	}

	body:has(.starlight-view-modes-zen-mode-no-sidebar) .container-main,
	body:has(.starlight-view-modes-zen-mode-no-sidebar) .main-pane {
		width: 100% !important;
		max-width: 90rem !important;
		margin: 0 auto !important;
		padding: 0 2rem !important;
	}

	body:has(.starlight-view-modes-zen-mode-no-sidebar) .sl-markdown-content {
		max-width: 80ch;
		margin: 0 auto;
	}

	/* ============================================ */
	/* Fix: Cards width on splash pages (homepage) */
	/* ============================================ */

	/* Limit content width on splash template to match header width */
	/* This prevents cards from stretching edge-to-edge on desktop */
	.page-wrapper:has(.hero) .sl-markdown-content {
		max-width: 96rem; /* 1536px - same as Starlight Black */
		margin-left: auto;
		margin-right: auto;
		padding-left: 2rem;
		padding-right: 2rem;
	}

	/* Ensure card grids respect the content width */
	.page-wrapper:has(.hero) .card-grid {
		max-width: 100%;
	}

	.markdown-wrapper {
		max-width: 96rem;
		margin-left: auto;
		margin-right: auto;
		padding-left: 2rem;
		padding-right: 2rem;
	}

	/* ============================================ */
	/* Fix: Mobile layout and overflow issues      */
	/* ============================================ */

	/* Prevent horizontal overflow on mobile */
	@media (max-width: 50rem) {
		/* Fix pagination links overflow */
		/* Stack Previous/Next buttons vertically on mobile */
		.pagination-links {
			display: flex !important;
			flex-direction: column !important;
			gap: 0.75rem !important;
			width: 100% !important;
		}

		.pagination-links a,
		.pagination-links .link {
			width: 100% !important;
			max-width: 100% !important;
			text-align: left !important;
			white-space: normal !important;
			word-wrap: break-word !important;
		}

		/* Prevent body horizontal scroll */
		body {
			overflow-x: hidden !important;
		}

		/* Adjust main content padding on mobile */
		main,
		.main-frame {
			padding-left: 1rem !important;
			padding-right: 1rem !important;
		}

		/* Fix splash page cards on mobile */
		.page-wrapper:has(.hero) .sl-markdown-content {
			padding-left: 1rem !important;
			padding-right: 1rem !important;
		}

		.markdown-wrapper {
			padding-left: 1rem !important;
			padding-right: 1rem !important;
		}

		/* Ensure sidebar drawer doesn't cover pagination when open */
		.mobile-sidebar-toggle {
			z-index: 100 !important;
		}

		/* Adjust header for mobile to prevent icon crowding */
		.site-title {
			flex-shrink: 1 !important;
			min-width: 0 !important;
		}

		/* Allow search bar to shrink on very small screens */
		.search {
			flex-shrink: 1 !important;
			max-width: 60% !important;
		}
	}

	/* Extra small devices (< 375px) */
	@media (max-width: 23.4375rem) {
		.search {
			max-width: 50% !important;
		}

		main,
		.main-frame,
		.page-wrapper:has(.hero) .sl-markdown-content,
		.markdown-wrapper {
			padding-left: 0.75rem !important;
			padding-right: 0.75rem !important;
		}
	}

	/* ============================================ */
	/* Fix: Mermaid diagrams in dark theme         */
	/* ============================================ */

	/* Override Mermaid custom classes to work with dark theme */
	/* Using lighter, more vibrant colors with better contrast */

	[data-theme="dark"] .mermaid .nivel100 {
		fill: #64b5f6 !important; /* Light blue background */
		stroke: #1976d2 !important; /* Darker blue border */
	}

	[data-theme="dark"] .mermaid .nivel200 {
		fill: #ffb74d !important; /* Light orange background */
		stroke: #f57c00 !important; /* Darker orange border */
	}

	[data-theme="dark"] .mermaid .nivel300 {
		fill: #ba68c8 !important; /* Light purple background */
		stroke: #7b1fa2 !important; /* Darker purple border */
	}

	/* Text inside nodes should be dark for better readability on light backgrounds */
	[data-theme="dark"] .mermaid .nivel100 .nodeLabel,
	[data-theme="dark"] .mermaid .nivel200 .nodeLabel,
	[data-theme="dark"] .mermaid .nivel300 .nodeLabel {
		fill: #1a1a1a !important;
		color: #1a1a1a !important;
	}

	/* General Mermaid text (labels, etc.) should be light for dark page background */
	[data-theme="dark"] .mermaid text,
	[data-theme="dark"] .mermaid .edgeLabel {
		fill: #e0e0e0 !important;
		color: #e0e0e0 !important;
	}

	/* Adjust Mermaid edge/arrow colors for dark theme */
	[data-theme="dark"] .mermaid .edgePath .path,
	[data-theme="dark"] .mermaid .flowchart-link {
		stroke: #9e9e9e !important;
	}

	/* Adjust marker (arrow) colors */
	[data-theme="dark"] .mermaid marker {
		fill: #9e9e9e !important;
		stroke: #9e9e9e !important;
		color: #9e9e9e !important;
	}

	/* ============================================ */
	/* Enhancement: Scrollable Mermaid Diagrams    */
	/* ============================================ */

	/* Allow the mermaid container to scroll horizontally */
	.mermaid {
		overflow-x: auto !important;
		width: 100% !important;
		margin-bottom: 2rem !important;
		padding-bottom: 1rem !important; /* Space for scrollbar */
		display: block !important;
	}

	/* Force the SVG to have a minimum width so it doesn't shrink */
	.mermaid svg {
		min-width: 1500px !important; /* Force wide chart */
		width: auto !important;
		max-width: none !important; /* Override theme limits */
		min-height: 600px !important;
		height: auto !important;
	}
}
